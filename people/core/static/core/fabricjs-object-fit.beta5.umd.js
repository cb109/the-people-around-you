!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).FabricJSObjectFit={})}(this,(function(t){"use strict";function e(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function o(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(t,e){if(null==t)return{};var o,n,r=function(t,e){if(null==t)return{};var o,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||(r[o]=t[o]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)o=i[n],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(r[o]=t[o])}return r}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,n=a(t);if(e){var r=a(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return l(this,o)}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var n,r,i=[],a=!0,c=!1;try{for(o=o.call(t);!(a=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){c=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(c)throw r}}return i}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){if(t){if("string"==typeof t)return b(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var g,v={FILL:"fill",NONE:"none",COVER:"cover",CONTAIN:"contain",SCALE_DOWN:"scale-down"},y={originX:"left",originY:"top"};t.Tag=void 0,(g=t.Tag||(t.Tag={}))[g.START=0]="START",g[g.CENTER=1]="CENTER",g[g.END=2]="END";var m,O,j=function(t){return{getAbsolute:function(e,o){return(e-o)*t},toString:function(){return"Point.fromFactor(".concat(t,")")},toJSON:function(){return{type:"fromFactor",args:[t]}}}},T=(i(m={},t.Tag.START,0),i(m,t.Tag.CENTER,.5),i(m,t.Tag.END,1),m),w=(i(O={},t.Tag.START,"Tag.START"),i(O,t.Tag.CENTER,"Tag.CENTER"),i(O,t.Tag.END,"Tag.END"),O),S=function(t){return o(o({},j(T[t])),{},{toString:function(){var e;return"Point.fromTag(".concat(null!==(e=w[t])&&void 0!==e?e:t,")")},toJSON:function(){return{type:"fromTag",args:[t]}}})},E=function(t,e){return o(o({},S(t)),{},{toString:function(){return"Point.".concat(e)}})},N={LEFT:E(t.Tag.START,"X.LEFT"),CENTER:E(t.Tag.CENTER,"X.CENTER"),RIGHT:E(t.Tag.END,"X.RIGHT")},_={TOP:E(t.Tag.START,"Y.TOP"),CENTER:E(t.Tag.CENTER,"Y.CENTER"),BOTTOM:E(t.Tag.END,"Y.BOTTOM")},C=function(t){return{getAbsolute:function(){return t},toString:function(){return"Point.fromAbsolute(".concat(t,")")},toJSON:function(){return{type:"fromAbsolute",args:[t]}}}},R=function(t,e){return t/e},A=function(t){return o(o({},j(R("string"==typeof t?parseInt(t):t,100))),{},{toString:function(){return"Point.fromPercentage(".concat(t,")")},toJSON:function(){return{type:"fromPercentage",args:[t]}}})},P=Object.freeze({__proto__:null,X:N,Y:_,fromAbsolute:C,fromFactor:j,fromPercentage:A,fromTag:S}),x={x:N.CENTER,y:_.CENTER},I=S(t.Tag.CENTER),F=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{switch(t.type){case"fromTag":return S.apply(void 0,f(t.args));case"fromAbsolute":return C.apply(void 0,f(t.args));case"fromPercentage":return A.apply(void 0,f(t.args));case"fromFactor":return j.apply(void 0,f(t.args));default:var o=t.type;throw new Error('The point type "'.concat(o,'" are not implemented'))}}catch(t){if(!e)throw t}return I},G=function(t){var e=t.x,o=t.y;return{x:e?F(e):x.x,y:o?F(o):x.y}},k=function(t){var e=t.left,n=void 0===e?0:e,r=t.top,i=void 0===r?0:r;return t.set(o(o({},y),{},{left:0,top:0})),t.setCoords(),{left:n,top:i}},X=function(t,e){var n=t.width,r=t.height,i=t.object,a=new e.Group(void 0,o(o({},y),{},{width:n,height:r})),c=new e.Rect(o(o({},y),{},{width:n,height:r,top:-R(r,2),left:-R(n,2)}));return a.add(i),a._updateObjectsCoords(),a.clipPath=c,a.setCoords(),a},Y=function(t,e,n){var r=e.width,i=e.height,a=e.position,c=(a=void 0===a?{}:a).x,u=void 0===c?x.x:c,s=a.y,l=void 0===s?x.y:s,d=k(t),h=d.left,f=d.top,p=Math.min(R(r,t.width),R(i,t.height));t.scaleX=p,t.scaleY=p;var b=new n.Group([t],o({},y));b.set({left:u.getAbsolute(r,b.width),top:l.getAbsolute(i,b.height)}),b.setCoords();var g=X({width:r,height:i,object:b},n);return g.set({top:f,left:h}),g.setCoords(),g},D=function(t,e,n){var r=e.width,i=e.height,a=e.position,c=(a=void 0===a?{}:a).x,u=void 0===c?x.x:c,s=a.y,l=void 0===s?x.y:s,d=k(t),h=d.left,f=d.top,p=Math.max(R(r,t.width),R(i,t.height));t.scaleX=p,t.scaleY=p;var b=new n.Group([t],o({},y));b.set({left:u.getAbsolute(r,b.width),top:l.getAbsolute(i,b.height)}),b.setCoords();var g=X({width:r,height:i,object:b},n);return g.set({left:h,top:f}),g.setCoords(),g},L=function(t,e,n){var r=e.width,i=e.height,a=e.position,c=(a=void 0===a?{}:a).x,u=void 0===c?x.x:c,s=a.y,l=void 0===s?x.y:s,d=k(t),h=d.left,f=d.top;t.scaleX=R(r,t.width),t.scaleY=R(i,t.height);var p=new n.Group([t],o({},y));p.set({left:u.getAbsolute(r,p.width),top:l.getAbsolute(i,p.height)}),p.setCoords();var b=X({width:r,height:i,object:p},n);return b.set({left:h,top:f}),b.setCoords(),b},W=function(t,e,n){var r=e.width,i=e.height,a=e.position,c=(a=void 0===a?{}:a).x,u=void 0===c?x.x:c,s=a.y,l=void 0===s?x.y:s,d=k(t),h=d.left,f=d.top;t.scaleX=1,t.scaleY=1;var p=new n.Group([t],o({},y));p.set({left:u.getAbsolute(r,p.width),top:l.getAbsolute(i,p.height)}),p.setCoords();var b=X({width:r,height:i,object:p},n);return b.set({left:h,top:f}),b.setCoords(),b},M=function(t,e,o){var n=e.width,r=e.height,i=t.width,a=void 0===i?0:i,c=t.height;return a>n||(void 0===c?0:c)>r?Y(t,e,o):W(t,e,o)},J=["mode"],U=function(t,e,o){var n=e.mode,r=u(e,J);switch(n){case v.COVER:return D(t,r,o);case v.CONTAIN:return Y(t,r,o);case v.FILL:return L(t,r,o);case v.NONE:return W(t,r,o);case v.SCALE_DOWN:return M(t,r,o);default:throw new Error('The fit mode "'.concat(n,'" are not implemented.'))}},B=["mode","width","height","object","position"],H=function(t){var e=t.util.qrDecompose([1,0,0,1,0,0]),a=function(a){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(m,a);var l,f,b,g=d(m);function m(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,m),i(s(e=g.call(this,void 0,o({},y))),"type","objectFit"),i(s(e),"mode",void 0),i(s(e),"width",void 0),i(s(e),"height",void 0),i(s(e),"useObjectTransform",void 0),i(s(e),"enableRecomputeOnScaled",void 0),i(s(e),"enableRecomputeOnScaling",void 0),i(s(e),"position",{}),i(s(e),"_object",null),i(s(e),"_objectGroup",null),i(s(e),"_loadedObjectTransform",{}),i(s(e),"_loadedObjectInitialTransform",{});var a=r.width,c=void 0===a?NaN:a,u=r.height,l=void 0===u?NaN:u,d=r.mode,h=void 0===d?v.FILL:d,f=r.useObjectTransform,p=void 0===f||f,b=r.enableRecomputeOnScaled,O=void 0===b||b,j=r.enableRecomputeOnScaling,T=void 0!==j&&j,w=r.position,S=(w=void 0===w?{}:w).x,E=void 0===S?x.x:S,N=w.y,_=void 0===N?x.y:N;return e.mode=h,e.width=c,e.height=l,e.position.x=E,e.position.y=_,e.useObjectTransform=p,e.enableRecomputeOnScaled=O,e.enableRecomputeOnScaling=T,e.object=null!=t?t:null,t&&e.recompute(),e.handleRecomputeOnScaled=e.handleRecomputeOnScaled.bind(s(e)),e.handleRecomputeOnScaling=e.handleRecomputeOnScaling.bind(s(e)),e.on("scaled",e.handleRecomputeOnScaled),e.on("scaling",e.handleRecomputeOnScaling),e}return l=m,f=[{key:"object",get:function(){return this._object},set:function(t){this.setObject(null!=t?t:null,this.useObjectTransform)}},{key:"setObject",value:function(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.detachObject(i),n){var a,c=n.calcTransformMatrix();this._loadedObjectInitialTransform.top=n.top,this._loadedObjectInitialTransform.left=n.left,this._loadedObjectInitialTransform.originX=n.originX,this._loadedObjectInitialTransform.originY=n.originY,Object.assign(this._loadedObjectInitialTransform,t.util.qrDecompose(c)),r&&(this._loadedObjectTransform=this._loadedObjectInitialTransform),n.set(e),n.setCoords(),null===(a=n.group)||void 0===a||a.removeWithUpdate(n),this._object=n,this._objectGroup=new t.Group([n],o({},y))}}},{key:"handleRecomputeOnScaled",value:function(){this.enableRecomputeOnScaled&&this.handleScaled()}},{key:"handleRecomputeOnScaling",value:function(){this.enableRecomputeOnScaling&&this.handleScaled()}},{key:"handleScaled",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setCoords(),this.set({scaleX:1,scaleY:1,width:this.getScaledWidth(),height:this.getScaledHeight()}),this.setCoords(),this.recompute(),e&&(null===(t=this.canvas)||void 0===t||t.requestRenderAll())}},{key:"recompute",value:function(){this._objectGroup&&(Number.isNaN(this.width)&&(this.width=this._objectGroup.width),Number.isNaN(this.height)&&(this.height=this._objectGroup.height));var e=this.width,o=this.height,n=this.mode,r=this.position,i=this.getCurrentTransformOptions();if(this.resetContainer(),this._objectGroup&&!Number.isNaN(e)&&!Number.isNaN(o)){var a=U(this._objectGroup,{mode:n,width:e,height:o,position:r},t);this.addWithUpdate(a)}this.set(i),this.setCoords(),this._loadedObjectTransform={},this.dirty=!0}},{key:"resetContainer",value:function(){this.setCoords(),this.set(o(o({},e),{},{top:0,left:0,width:this.getScaledWidth(),height:this.getScaledHeight()})),this.setCoords();var t,n=function(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=p(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==o.return||o.return()}finally{if(c)throw i}}}}(this.getObjects());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.removeWithUpdate(r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"getCurrentTransformOptions",value:function(){var t=o(o(o(o({},y),e),this),this._loadedObjectTransform),n=t.angle,r=t.skewX,i=t.skewY,a=t.scaleX,c=t.scaleY,u=t.originX,s=t.originY,l=t.top,d=void 0===l?0:l,h=t.left;return{left:void 0===h?0:h,top:d,angle:n,originX:u,originY:s,scaleX:a,scaleY:c,skewX:r,skewY:i}}},{key:"detachObject",value:function(){var t,e,o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this._object;return this._objectGroup&&(null===(t=this._objectGroup.group)||void 0===t||t.removeWithUpdate(this._objectGroup),this._objectGroup=null),this._object&&(null===(e=this._object.group)||void 0===e||e.removeWithUpdate(this._object),this._object.setCoords(),o&&(this._object.set(this._loadedObjectInitialTransform),this._object.setCoords()),this._object=null),this._loadedObjectTransform={},this._loadedObjectInitialTransform={},n}},{key:"toObject",value:function(e){var o,n,r;return t.util.object.extend(this.callSuper("toObject",["mode","width","height"].concat(null!=e?e:[])),{position:{x:null===(o=this.position.x)||void 0===o?void 0:o.toJSON(),y:null===(n=this.position.y)||void 0===n?void 0:n.toJSON()},object:null===(r=this.object)||void 0===r?void 0:r.toObject()})}}],b=[{key:"fromObject",value:function(e,o){var n=e.mode,r=e.width,i=e.height,a=e.object,c=e.position,s=u(e,B);!function(t,e,o){t?o.util.enlivenObjects([t],(function(t){var o=h(t,1)[0];e(o)}),void 0):e(null)}(a,(function(t){var e=new m(t,{mode:n,width:r,height:i,position:G(c)});e.set(s),e.setCoords(),null==o||o(e)}),t)}}],f&&r(l.prototype,f),b&&r(l,b),Object.defineProperty(l,"prototype",{writable:!1}),m}(t.Group);return a};t.FitMode=v,t.Point=P,t.createObjectFitClass=H,t.defaultPosition=x,t.getContainFittedObject=Y,t.getCoverFittedObject=D,t.getFillFittedObject=L,t.getFittedObject=U,t.getNoneFittedObject=W,t.getScaleDownFittedObject=M,t.parsePoint=F,t.parsePosition=G,t.setup=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.assingClassesToNamespace,n=void 0===o||o,r=H(t);return n&&Object.assign(t,{ObjectFit:r}),{ObjectFit:r}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.js.map
